–ö–æ–Ω–µ—á–Ω–æ! –ù–∏–∂–µ ‚Äî **—á—ë—Ç–∫–æ–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞**, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–¥–æ–π–¥—ë—Ç –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, —Ä–µ–∑—é–º–µ –∏–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏.

---

## üèóÔ∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞: –ü–æ—Ç–æ–∫–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

### üéØ –û–±—â–∞—è —Ü–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–ª—è **—Å–±–æ—Ä–∞, –ø–µ—Ä–µ–¥–∞—á–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**, –∏–º–∏—Ç–∏—Ä—É—é—â—É—é —Ä–∞–±–æ—Ç—É —Å–µ—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤, —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –≤—ã—Ä—É—á–∫–∏ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫–Ω–∞–º.

---

### üìê –û–±—â–∞—è —Å—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```
+----------------+     +----------------+     +----------------+     +------------------+
|  –ü—Ä–æ–¥—é—Å–µ—Ä—ã     | --> |   Apache Kafka  | --> | Spark Streaming | --> |   –í—ã–≤–æ–¥ / –ê–Ω–∞–ª–∏–∑  |
| (–ú–∞–≥–∞–∑–∏–Ω—ã)     |     | (–û—á–µ—Ä–µ–¥—å —Å–æ–±—ã—Ç–∏–π)|     | (–û–±—Ä–∞–±–æ—Ç–∫–∞)     |     | (–ö–æ–Ω—Å–æ–ª—å, –ë–î –∏ —Ç.–¥.)|
+----------------+     +----------------+     +----------------+     +------------------+
```

---

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äî –ü—Ä–æ–¥—é—Å–µ—Ä—ã (Producer)**
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è**: Python + `kafka-python`
- **–†–æ–ª—å**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –æ –ø—Ä–æ–¥–∞–∂–∞—Ö.
- **–§–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏—è (JSON)**:
  ```json
  {
    "store": "store-1",
    "item": "product-5",
    "price": 75.3,
    "ts": 1756584000
  }
  ```
- **–ö–ª—é—á Kafka**: `store` ‚Äî –¥–ª—è –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º.
- **–¢–æ–ø–∏–∫**: `sales`
- **–ß–∞—Å—Ç–æ—Ç–∞**: ~1 —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–µ–∫—É–Ω–¥—É (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è).
- **–õ–æ–≥–∏–∫–∞**: –ò–º–∏—Ç–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞–≥–∞–∑–∏–Ω–æ–≤, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —á–µ–∫–∏.

---

### 2. **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî Apache Kafka (–≤ Docker)**
- **–ó–∞–ø—É—Å–∫**: –ß–µ—Ä–µ–∑ `docker-compose.yml` —Å Zookeeper.
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ü—Ä–∏—ë–º –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π,
  - –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ,
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π,
  - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–ª—é—á—É (`store`).
- **–¢–æ–ø–∏–∫**: `sales` (1 –ø–∞—Ä—Ç–∏—Ü–∏—è, replication factor = 1).
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
  - `auto.create.topics.enable` ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–æ,
  - `retention.ms` ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

> ‚úÖ Kafka –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ **–Ω–∞–¥—ë–∂–Ω—ã–π –±—É—Ñ–µ—Ä** –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.

---

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ ‚Äî Spark Structured Streaming**
- **–î–≤–∏–∂–æ–∫**: Apache Spark (PySpark)
- **–†–µ–∂–∏–º**: Structured Streaming (–ø–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π event-time).
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –ß–µ—Ä–µ–∑ `spark-sql-kafka-0-10` connector.
- **–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏**:

| –≠—Ç–∞–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|
| **–ß—Ç–µ–Ω–∏–µ –∏–∑ Kafka** | –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫ `sales`, –ø–æ–ª—É—á–µ–Ω–∏–µ `key`, `value`, `timestamp` |
| **–ü–∞—Ä—Å–∏–Ω–≥ JSON** | –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ `value` –∏–∑ —Å—Ç—Ä–æ–∫–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è |
| **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** | –ü–æ–ª–µ `ts` (int) ‚Üí `event_time` (timestamp) |
| **Watermarking** | `.withWatermark("event_time", "30 seconds")` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫ |
| **–û–∫–æ–Ω–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è** | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ `store` –∏ 30-—Å–µ–∫—É–Ω–¥–Ω—ã–º –æ–∫–Ω–∞–º |
| **–ê–≥—Ä–µ–≥–∞—Ü–∏—è** | –°—É–º–º–∞ `price` ‚Üí `total_revenue` |
| **–í—ã–≤–æ–¥** | –í –∫–æ–Ω—Å–æ–ª—å (—Ä–µ–∂–∏–º `update`, —Ç—Ä–∏–≥–≥–µ—Ä –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥) |

---

### 4. **–ü—Ä–∏—ë–º–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö ‚Äî Sink**
- **–¢–µ–∫—É—â–∏–π sink**: –ö–æ–Ω—Å–æ–ª—å (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏).
- **–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞**:
  - –ú–∞–≥–∞–∑–∏–Ω,
  - –°—É–º–º–∞—Ä–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ (–æ–∫—Ä—É–≥–ª—ë–Ω–Ω–∞—è),
  - –ù–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–∫–Ω–∞.
- **–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è**:
  - PostgreSQL / ClickHouse,
  - Parquet-—Ñ–∞–π–ª—ã (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏),
  - –î—Ä—É–≥–æ–π Kafka-—Ç–æ–ø–∏–∫ (–¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏),
  - REST API / –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## üï∞Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

- **Event Time**: –í—Ä–µ–º—è –ø—Ä–æ–¥–∞–∂–∏ (`ts` –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è).
- **Ingestion Time**: –í—Ä–µ–º—è –ø—Ä–∏—ë–º–∞ –≤ Kafka (`timestamp` –æ—Ç –±—Ä–æ–∫–µ—Ä–∞).
- **Watermark**: –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–æ 30 —Å–µ–∫—É–Ω–¥ ‚Äî –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏—à–ª–æ –ø–æ–∑–∂–µ, —á–µ–º `event_time + 30 —Å–µ–∫`, –æ–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.
- **–û–∫–Ω–∞**: 30-—Å–µ–∫—É–Ω–¥–Ω—ã–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–∫–Ω–∞ (tumbling windows).

---

## üß± –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –≠–ª–µ–º–µ–Ω—Ç | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|--------|-----------|
| **–õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ** | Docker (Kafka + Zookeeper) |
| **–Ø–∑—ã–∫** | Python (–¥–ª—è –ø—Ä–æ–¥—é—Å–µ—Ä–∞ –∏ Spark) |
| **–§—Ä–µ–π–º–≤–æ—Ä–∫** | PySpark 3.4.1 |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | `kafka-python`, `pyspark` |
| **–ó–∞–ø—É—Å–∫** | –õ–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ |

---

## üìà –ü—Ä–∏–º–µ—Ä –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –ú–∞–≥–∞–∑–∏–Ω `store-1` –ø—Ä–æ–¥–∞—ë—Ç —Ö–ª–µ–± –∑–∞ 50 —Ä—É–±. ‚Üí —Å–æ–±—ã—Ç–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è.
2. –ü—Ä–æ–¥—é—Å–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ Kafka –≤ —Ç–æ–ø–∏–∫ `sales` —Å –∫–ª—é—á–æ–º `store-1`.
3. Spark —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–∞—Ä—Å–∏—Ç JSON, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç `ts` –≤ `timestamp`.
4. –°–æ–±—ã—Ç–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ 30-—Å–µ–∫—É–Ω–¥–Ω–æ–µ –æ–∫–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10:00:00 ‚Äì 10:00:30).
5. Spark –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ `store-1` –≤ —ç—Ç–æ–º –æ–∫–Ω–µ.
6. –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ (–ø–æ —Ç—Ä–∏–≥–≥–µ—Ä—É) —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å.

---

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ | –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
|-------------|-----------------|
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | –ù–µ—Å–∫–æ–ª—å–∫–æ –º–∞–≥–∞–∑–∏–Ω–æ–≤ ‚Üí Kafka ‚Üí Spark –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ |
| **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** | Kafka —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ, Spark –º–æ–∂–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ |
| **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –≤ —Å–µ–∫—É–Ω–¥—ã |
| **–ì–∏–±–∫–æ—Å—Ç—å** | –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏, sink‚Äô–∏, –ª–æ–≥–∏–∫—É |
| **–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏** | Kafka –∏ Spark ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–µ-—Ñ–∞–∫—Ç–æ –≤ big data |

---

## üîÑ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

| –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|
| **Checkpointing** | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è Spark –≤ —Ñ–∞–π–ª (—á—Ç–æ–±—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ —Ç–µ—Ä—è–ª –¥–∞–Ω–Ω—ã–µ) |
| **–ó–∞–ø–∏—Å—å –≤ –ë–î** | –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ PostgreSQL —á–µ—Ä–µ–∑ `.foreachBatch()` |
| **Schema Registry** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Avro + Schema Registry –¥–ª—è —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ |
| **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** | Prometheus + Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫ |
| **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** | –ó–∞–ø—É—Å–∫ Spark –≤ standalone-—Ä–µ–∂–∏–º–µ –∏–ª–∏ –Ω–∞ Kubernetes |

---

## üìå –ò—Ç–æ–≥

–≠—Ç–æ **–º–æ–¥—É–ª—å–Ω–∞—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏**, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è—Ö. –û–Ω–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –†–∞–±–æ—Ç—É —Å event time –∏ watermark‚Äô–∞–º–∏,
- –ê–≥—Ä–µ–≥–∞—Ü–∏—é –≤ –æ–∫–Ω–∞—Ö,
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏,
- –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –≤ production-—Å—Ä–µ–¥—É.

---

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –º–æ–≥—É –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å **–¥–∏–∞–≥—Ä–∞–º–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ (ASCII)** –∏–ª–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown / PDF**.