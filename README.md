–ü–æ—Ç–æ–∫–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Kafka –∏ Spark Streaming

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–±–æ—Ä–∞, –ø–µ—Ä–µ–¥–∞—á–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –∏–º–∏—Ç–∏—Ä—É—é—â—É—é —Ä–∞–±–æ—Ç—É —Å–µ—Ç–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤, –≥–¥–µ:

–ö–∞–∂–¥—ã–π –º–∞–≥–∞–∑–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ–∫–∏,
–î–∞–Ω–Ω—ã–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è,
–°–∏—Å—Ç–µ–º–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –≤—ã—Ä—É—á–∫—É –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º.

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
Apache Kafka
–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –ø—Ä–∏—ë–º–∞ –∏ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–∞ —Å–æ–±—ã—Ç–∏–π
Python (kafka-python)
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (–ø—Ä–æ–¥—é—Å–µ—Ä)
Spark Structured Streaming
–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–∞: –∞–≥—Ä–µ–≥–∞—Ü–∏—è, –æ–∫–Ω–∞, watermark
Docker
–ó–∞–ø—É—Å–∫ Kafka –∏ Zookeeper –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
PySpark
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Spark-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Python


–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã


1
[–ú–∞–≥–∞–∑–∏–Ω—ã] ‚Üí (–ü—Ä–æ–¥—é—Å–µ—Ä—ã) ‚Üí [Kafka] ‚Üí (Spark Streaming) ‚Üí [–ö–æ–Ω—Å–æ–ª—å / –ê–Ω–∞–ª–∏–∑]
1. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π (producer.py)
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É.
–°–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:
store ‚Äî –º–∞–≥–∞–∑–∏–Ω (–∫–ª—é—á –¥–ª—è –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è),
item ‚Äî —Ç–æ–≤–∞—Ä,
price ‚Äî —Ü–µ–Ω–∞,
ts ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ (Unix timestamp).
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —Ç–æ–ø–∏–∫ Kafka sales.
2. Kafka (–≤ Docker)
–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–æ–ø–∏–∫–µ sales.
–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.
–ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.
3. Spark Streaming (streaming.py)
–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Kafka –∏ —á–∏—Ç–∞–µ—Ç –ø–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π.
–ü–∞—Ä—Å–∏—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏—è.
–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç Unix-–≤—Ä–µ–º—è (ts) –≤ —Ç–∏–ø timestamp.
–ü—Ä–∏–º–µ–Ω—è–µ—Ç –æ–∫–æ–Ω–Ω—É—é –∞–≥—Ä–µ–≥–∞—Ü–∏—é:
–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –º–∞–≥–∞–∑–∏–Ω—É –∏ 30-—Å–µ–∫—É–Ω–¥–Ω—ã–º –æ–∫–Ω–∞–º,
–ü–æ–¥—Å—á—ë—Ç —Å—É–º–º–∞—Ä–Ω–æ–π –≤—ã—Ä—É—á–∫–∏.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç withWatermark –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö.
–í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å.
üìä –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞?
–ö–∞–∂–¥—ã–µ ~10 —Å–µ–∫—É–Ω–¥ (–ø–æ —Ç—Ä–∏–≥–≥–µ—Ä—É) Spark –≤—ã–≤–æ–¥–∏—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã:


+-------+------------------+-------------------+-------------------+
|store  |total_revenue_int |window_start       |window_end         |
+-------+------------------+-------------------+-------------------+
|store-1|287               |2025-09-02 10:30:00|2025-09-02 10:30:30|
|store-2|315               |2025-09-02 10:30:00|2025-09-02 10:30:30|
+-------+------------------+-------------------+-------------------+
üëâ –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª 10:30:00 ‚Äì 10:30:30:

store-1 –∑–∞—Ä–∞–±–æ—Ç–∞–ª 287 —Ä—É–±.,
store-2 ‚Äî 315 —Ä—É–±.
‚úÖ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
Spark —á–∏—Ç–∞–µ—Ç Kafka "–Ω–∞ –ª–µ—Ç—É"
–û–∫–æ–Ω–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è
30-—Å–µ–∫—É–Ω–¥–Ω—ã–µ –æ–∫–Ω–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è (
event time
)
–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–µ—Ä–∂–µ–∫
withWatermark("event_time", "30 seconds")
–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–∞–≥–∞–∑–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ –∫–ª—é—á–∏ Kafka
–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
Spark –º–æ–∂–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ checkpoint (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)

